const cam_transforms = [
    [0.8314616111949538, -0.015185022271199682, 0.5553745967740221, -8.655224430937372, -0.0013900887845742882, -0.9996801366350629, -0.025252073864102564, 12.525067225264179, 0.555580414394057, 0.020224110647540816, -0.8312167965479965, 11.599932631706883, 0.0, 0.0, 0.0, 1.0],
    [0.8799466426931789, 0.05462317152819811, -0.4719218199230221, 7.299052258083131, 0.01490214681916256, -0.9960528083017982, -0.08750277409279385, 4.802193524742715, -0.474838740917208, 0.06996512798075635, -0.8772873264237762, 13.804840806742128, 0.0, 0.0, 0.0, 1.0],
    [0.9810545314462906, -0.06682775519481592, 0.1818408837153212, -4.139957116477906, -0.0025386187567822973, -0.9429751277806215, -0.3328535461600391, 19.29545911489768, 0.19371527407162895, 0.32608586812390217, -0.9252796600170855, 15.202001792450167, 0.0, 0.0, 0.0, 1.0],
    [0.9921358283764521, -0.092644553188133, 0.08416311913681508, -1.8741103259802436, -0.08212067414805253, -0.9892625853091196, -0.12089531128531185, 16.867775658489503, 0.09445972243272052, 0.11303304730747114, -0.9890909649242596, 20.2413915284868, 0.0, 0.0, 0.0, 1.0],
    [0.16411266665662266, 0.2449720208593868, -0.9555394766300183, 13.603419471643127, 0.06113811086120476, -0.9693368142927976, -0.23800886063426396, 15.155188370209077, -0.9845451395743241, -0.01935960929925348, -0.17405757939370167, 1.979263296930505, 0.0, 0.0, 0.0, 1.0],
    [0.3126257637584518, 0.03230375851418365, -0.9493269146062155, 14.957249881932674, -0.008663404433370474, -0.9992830037678441, -0.03685663840851915, 5.121627660593224, -0.9498368964987497, 0.019746736980625366, -0.31212173057763437, 4.717349887700108, 0.0, 0.0, 0.0, 1.0],
    [0.2994623967775029, 0.41440646807855347, -0.8594123624578136, 14.91606432759238, 0.04032671140268592, -0.905442038767211, -0.4225500164721977, 19.136708537391, -0.9532555114004755, 0.0918805603552211, -0.2878574835345392, 4.743660088105565, 0.0, 0.0, 0.0, 1.0],
    [-0.4369464908659022, 0.0802336358840382, -0.895901953322288, 13.358042168312357, 0.01187933043934647, -0.9954122206079148, -0.09493914851469429, 13.026658643438074, -0.8994090559664001, -0.05212604462618309, 0.43398872865893734, -6.8172884181283235, 0.0, 0.0, 0.0, 1.0],
    [-0.7632098611351515, 0.042336603133292905, -0.6447621997936047, 9.174565155650816, -0.016073744211031773, -0.9987863659926555, -0.04655604718388718, 12.901590583515087, -0.6459506991881722, -0.025168291944682075, 0.7629640843388901, -10.658481285170724, 0.0, 0.0, 0.0, 1.0],
    [0.5265199809311578, -0.1192533443309996, 0.8417573171480529, -12.770076863148871, -0.04875665253167347, -0.9927191710010226, -0.11014305909992197, 12.123066073690726, 0.8487635144332706, 0.01695125429454911, -0.5285008332156005, 7.298158426789239, 0.0, 0.0, 0.0, 1.0],
    [0.19090710355024443, -0.10229009968580594, 0.9762639327108783, -13.86632328029239, -0.05242134193483298, -0.9941988346003479, -0.09391835083991215, 12.475807679538756, 0.9802073511665714, -0.0332473850817369, -0.19516179594752026, 1.5591364784974873, 0.0, 0.0, 0.0, 1.0],
    [-0.12723387501429992, -0.1146723666642962, 0.9852217082603779, -14.16448784330011, 0.010199661930496417, -0.9933932129917005, -0.11430626606460573, 5.040417490790735, 0.9918203262458606, -0.004494700132184783, 0.12756287799387453, -4.136795484362195, 0.0, 0.0, 0.0, 1.0],
    [0.8364009311589339, -0.2319751242308839, 0.49660952774509814, -8.858230054696405, -0.0027930844919465746, -0.9078185310006948, -0.4193539610627969, 19.044331741097913, 0.5481110093964107, 0.34936097004075106, -0.7599481530141013, 11.183355893823167, 0.0, 0.0, 0.0, 1.0],
    [0.8644307519419273, 0.4127075298360828, -0.28710965410438005, 7.566879172167189, 0.06646578536709756, -0.6598767002314796, -0.7484283524566249, 24.584001900609405, -0.49833897688616186, 0.6278815746794886, -0.597848652483582, 13.828292154547581, 0.0, 0.0, 0.0, 1.0],
    [0.3009411768818164, -0.22404396233034418, 0.9269513108743395, -12.733409394182184, -0.07711421131041482, -0.9745451424240896, -0.21051172749971897, 15.125888771412106, 0.9505197738959551, -0.00812947484657748, -0.3105577340522391, 2.858168745993266, 0.0, 0.0, 0.0, 1.0],
    [-0.38652948076976573, 0.43700319980135244, -0.8121718597847113, 13.45107777805376, 0.0038738403426905265, -0.8798388912226266, -0.4752562823398336, 18.783781281514162, -0.9222688950838198, -0.18684679444676797, 0.3383907962488163, -6.359047755271542, 0.0, 0.0, 0.0, 1.0],
    [0.843388818712609, -0.12481772462135118, 0.5226048314252574, -10.966809943311116, -0.020363451906143127, -0.9793698043409076, -0.20104751139962035, 16.966718449484784, 0.5369176811671432, 0.1589191875629653, -0.8285313080618957, 16.50713454153526, 0.0, 0.0, 0.0, 1.0],
    [-0.22497273969843393, -0.42162257925980573, 0.8784199736172904, -14.269530201732747, -0.04703664256901072, -0.8957801584520292, -0.4420016630587986, 18.451286716282702, 0.9732290877032339, -0.14075624767143696, 0.18169441006044046, -4.049810840009262, 0.0, 0.0, 0.0, 1.0],
    [0.8839645259808065, 0.18133721433333075, -0.4309565260846235, 7.757395872539144, 0.009053582558881257, -0.9281915690888299, -0.371992571328752, 18.2791914310338, -0.4674662980882899, 0.32492653976841485, -0.8221301887168532, 14.060057618300636, 0.0, 0.0, 0.0, 1.0],
    [0.673629494481891, 0.07081550289491662, -0.7356686998747903, 11.602188622984054, -0.004088234559663258, -0.9950266618355654, -0.09952478306011198, 13.025016286544796, -0.7390578909198555, 0.07005041888761207, -0.6699898279393326, 9.458541928020454, 0.0, 0.0, 0.0, 1.0],
    [0.5585110086950323, 0.04624993408089923, 0.8282067463233826, -12.505042652770454, 0.07104973086730008, -0.9974423855597194, 0.007787411444733569, 4.457873146748084, 0.82644863544765, 0.05449451425986402, -0.5603685975072393, 7.448798089997852, 0.0, 0.0, 0.0, 1.0],
    [-0.20368502788435605, 0.009169028300279429, 0.9789935311430826, -14.180286297233891, 0.022836833522049908, -0.9996395811920226, 0.014113724028480079, 13.055215015903327, 0.9787701016027521, 0.025231867779600275, 0.20340222790924783, -3.8149309052573845, 0.0, 0.0, 0.0, 1.0],
    [-0.030270265571090964, 0.08865200500539547, -0.9956025879609159, 14.829061479492337, 0.03671998798647492, -0.9952880210346823, -0.08974042853765556, 13.264523610673125, -0.998867034948911, -0.0392749821203124, 0.026872332448652225, -0.9413696750510938, 0.0, 0.0, 0.0, 1.0],
    [-0.7521699338754448, -0.04917352263044001, -0.6571318844334053, 9.30658384026276, 0.024821883721108752, -0.9986184274025642, 0.04631537446138272, 4.6767081342386545, -0.6585015160801347, 0.01852578175879719, 0.7523513585361224, -10.76069751128411, 0.0, 0.0, 0.0, 1.0],
    [-0.5748542527968743, -0.20510892285206742, 0.7921318602280005, -10.607428545618637, -0.03691244548807388, -0.960587765445974, -0.2755152276224135, 12.602058385079765, 0.8174228227542483, -0.18762062312196234, 0.5446268767752871, -8.90622120036837, 0.0, 0.0, 0.0, 1.0],
    [-0.8310182952703017, -0.21982100414182004, 0.5109670082921547, -6.856126875707918, -0.025032089785330433, -0.9028909237259312, -0.42914028327744375, 19.386544632116415, 0.5556815273615846, -0.3694140028590378, 0.7448163164985093, -13.06072677629832, 0.0, 0.0, 0.0, 1.0],
    [-0.7317092647580279, 0.3700743571237701, -0.5724041234475956, 9.155485684913934, -0.05872844893252043, -0.8708802559243761, -0.4879739327900981, 18.655217167479897, -0.6790820971408233, -0.32343864503380576, 0.6589650675715321, -10.497045354347003, 0.0, 0.0, 0.0, 1.0],
    [-0.887874763490844, -0.0940208444895884, 0.4503759820490146, -6.915194850282208, 0.03628794365927191, -0.9901580167263243, -0.13516783203608784, 13.41627394509211, 0.4586519723051523, -0.10366888106071384, 0.8825480926424573, -13.070814540267323, 0.0, 0.0, 0.0, 1.0],
    [-0.9656265473979768, 0.0997451352107616, -0.24003392157417616, 4.51988729576758, 0.010921354898465616, -0.9070597245301065, -0.4208602711634188, 18.431801281951522, -0.259703881345133, -0.4090153499166745, 0.8747915695752719, -14.0472346187794, 0.0, 0.0, 0.0, 1.0],
    [-0.5262703453237128, -0.013247906260704594, 0.8502140866848652, -10.531607967144504, 0.0008480073600492172, -0.9998862758161953, -0.015055171496110414, 5.0122006423979535, 0.8503168969102591, -0.007202102497567779, 0.5262217230114047, -8.60601788934381, 0.0, 0.0, 0.0, 1.0],
    [-0.9458105709836359, 0.0299221242728397, -0.32333727548131136, 4.710846061189456, 0.0042710578250603195, -0.9945128514437132, -0.10452723269387892, 13.301155475597863, -0.32469072896775775, -0.10024395164145303, 0.9404929989705234, -14.328048577896185, 0.0, 0.0, 0.0, 1.0],
    [-0.5977406341256006, -0.35338881631470964, 0.7195988702543992, -10.752936454242118, -0.03057152011452189, -0.8869021898592796, -0.46094454251956063, 18.483371595900703, 0.8011064447544454, -0.29752449318189433, 0.5193338225951498, -8.852471574494412, 0.0, 0.0, 0.0, 1.0],
    [-0.04308166326794391, -0.008284546229260805, -0.9990372034224886, 14.753015684650023, -0.06014011277314744, -0.9981307671935606, 0.010870462807673665, 4.608165843422742, -0.9972598329638258, 0.06055052753598428, 0.04250290046780012, -1.1896583604928181, 0.0, 0.0, 0.0, 1.0],
    [0.9929526342133947, 0.013617893975685438, -0.1177268380793824, 1.804384249136234, -0.07127088420945221, -0.7250531699927129, -0.6849951115886068, 24.88271162578722, -0.09468640916930815, 0.688558242309858, -0.7189728987889592, 13.073489044888538, 0.0, 0.0, 0.0, 1.0],
    [-0.9986084244798807, 0.052717063049225917, 0.0014628377032920143, 0.7520489886471381, -0.03534104631284395, -0.6483546140814056, -0.7605177683943675, 25.011111672041068, -0.0391438245676611, -0.7595111215255911, 0.6493154615590346, -13.408119891346056, 0.0, 0.0, 0.0, 1.0],
    [0.6650005151839197, 0.31547123259486853, -0.6769432922821699, 11.621294893931035, 0.027929591470392784, -0.9162773184880763, -0.3995695671319404, 18.895781113498987, -0.7463204811856622, 0.246807222621022, -0.6181358349702256, 9.487998544861757, 0.0, 0.0, 0.0, 1.0],
    [0.9979184403840077, -0.05114443355432947, -0.03928163319234658, 1.9546969550552622, -0.047555618371470675, -0.9950359684799026, 0.08741800129637436, 4.473284713905017, -0.04355758199365545, -0.08536797114426585, -0.995396946340754, 14.766654507263793, 0.0, 0.0, 0.0, 1.0],
    [0.9938257273678919, 0.04306297447129052, -0.10225457575912411, 1.7208362592614055, 0.0005539767865333269, -0.9235226451199775, -0.3835434957506737, 19.313127710833914, -0.11095093514649028, 0.38111874751177083, -0.9178444379252465, 14.880861083042856, 0.0, 0.0, 0.0, 1.0],
    [0.8975914354573813, 0.05249095604256533, -0.4376920653260527, 7.750720635708476, 0.01178305550202711, -0.9953875280407951, -0.09520956856335878, 12.961344245611484, -0.44067084658848077, 0.08030194516466503, -0.8940698036818374, 13.74080423563992, 0.0, 0.0, 0.0, 1.0],
    [0.9976451728592289, 0.026084295284503418, -0.06343304629849146, 1.8411680203331982, 0.01047363040737572, -0.9719506753399426, -0.2349513822117457, 12.429081768673816, -0.06778233923315957, 0.23373373438628953, -0.9699350765799583, 14.893673334142383, 0.0, 0.0, 0.0, 1.0],
    [0.7847660964348976, 0.10314048789286052, -0.6111498618480777, 13.503988822529818, 0.020855347460442007, -0.9898923679625954, -0.1402788590669296, 17.126607083009663, -0.6194410377233874, 0.09734034921748093, -0.7789850149013893, 16.377701231557563, 0.0, 0.0, 0.0, 1.0],
    [0.789791436320781, -0.03904784045493614, 0.6121313061899227, -8.880506566123728, -0.07876568154393196, -0.9961655561261581, 0.038080635423802245, 4.405928808170289, 0.6082971459570167, -0.07829069669599521, -0.7898386808880445, 11.551515222271926, 0.0, 0.0, 0.0, 1.0],
    [0.6391014256521557, 0.03271324128961333, -0.7684264582580725, 11.309117100325375, 0.007847899287346598, -0.9993204311298548, -0.036015687196743196, 4.406632495639119, -0.7690824581654192, 0.016987142001742332, -0.6389237938113457, 9.612317929645876, 0.0, 0.0, 0.0, 1.0],
    [0.9533862211832553, 0.018317032343465454, 0.30119623208004714, -4.10687570954646, -0.005506896876514076, -0.996933550991579, 0.07805895429714403, 4.917072252159901, 0.30170244116432743, -0.0760789856711601, -0.9503618302274085, 15.44284292134251, 0.0, 0.0, 0.0, 1.0],
    [0.9639580602816368, -0.0212575742735581, 0.26520360727863396, -3.8992238200665894, -0.014638367553001552, -0.9995306369049433, -0.0269107412654034, 12.400240769569242, 0.2656511764022218, 0.022058677931168207, -0.9638168178021771, 14.792736964897259, 0.0, 0.0, 0.0, 1.0],
    [0.9789799837406337, 0.07031131809940525, -0.19145362148439207, 3.9034138472284425, 0.037650290371667346, -0.9848672857502367, -0.1691712074678645, 17.13726667170176, -0.20045105453936604, 0.15840693601810663, -0.9668126011615242, 20.093220892004094, 0.0, 0.0, 0.0, 1.0],
    [0.5797864678900826, 0.14066574837103554, -0.8025339785938851, 16.10085898991972, -0.011161532472421498, -0.9835204326174171, -0.18045210840282802, 17.025231526582843, -0.8146919921097051, 0.11358120275835455, -0.5686617954516964, 11.321565927774977, 0.0, 0.0, 0.0, 1.0],
    [0.3239680421391478, 0.10977290375671951, -0.9396779078289486, 14.573906137157639, 0.004311201974132075, -0.9934066378874503, -0.11456312351974965, 12.96454161512846, -0.946058186240379, 0.033063650887790445, -0.32230524751821815, 4.827335577568831, 0.0, 0.0, 0.0, 1.0],
    [-0.025813218101402628, 0.43134503900323007, -0.9018176854209141, 14.707476999361612, -0.04722917106931692, -0.9016371412594731, -0.42990682687240633, 19.162455028096215, -0.9985505075096602, 0.03149482427938573, 0.043646224279106235, -1.0288501836803698, 0.0, 0.0, 0.0, 1.0],
    [-0.4633463081497912, 0.07442229058999425, -0.8830466941465697, 14.086608619331047, -0.05982638052333457, -0.9968209726876867, -0.05261937504130293, 5.042687761788868, -0.8841555375764647, 0.02844849391978753, 0.4663257402952953, -7.0411931806140355, 0.0, 0.0, 0.0, 1.0],
    [0.20348758883771018, -0.004503428808107093, 0.9790671929647952, -14.145073210511269, 0.036717001528345075, -0.9992509009258356, -0.012227465225985069, 4.642759145563235, 0.9783888360000748, 0.038436548957405565, -0.2031697989945266, 1.4557799442277917, 0.0, 0.0, 0.0, 1.0],
    [0.24168740822892545, -0.402460048123172, 0.8829569952111361, -13.610739420627551, -0.0053688250492684225, -0.910473456518253, -0.41353272596826196, 18.828410948910076, 0.9703393153314963, 0.09520521144345932, -0.22221070525580802, 1.849694422536007, 0.0, 0.0, 0.0, 1.0],
    [0.5786712306270949, -0.3238468512855279, 0.7485070565617544, -13.085683998968973, 0.01069012615123007, -0.9146911880077407, -0.40401210949667665, 19.009887947807506, 0.8154908697903633, 0.24179182259717275, -0.5258434875669097, 7.698958301203049, 0.0, 0.0, 0.0, 1.0],
    [0.6610681625388048, -0.11457864725421386, 0.741525871820934, -15.226662913717643, -0.007654801900328558, -0.9892502172663602, -0.14603214426814767, 16.90856597608527, 0.7502868093401464, 0.09086095969438737, -0.6548388767791476, 12.909474536109114, 0.0, 0.0, 0.0, 1.0],
    [0.9286324537029811, -0.29219950623214924, 0.22860702299952027, -6.115388963728514, -0.022476885859746495, -0.6593686690811933, -0.7514836949504248, 24.59288497442886, 0.3703194674774349, 0.6927137698221533, -0.6188789096844132, 14.182880811860747, 0.0, 0.0, 0.0, 1.0],
    [0.025235618660018323, 0.7010588488677646, -0.7126567631465568, 14.893489943468364, 0.007146602316185418, -0.7129920881764301, -0.7011356932101618, 24.914865870622183, -0.9996560093304144, 0.01260051832632778, -0.02300298419772123, -0.34165606263346077, 0.0, 0.0, 0.0, 1.0],
    [0.10164686097307177, -0.6565012004347466, 0.7474450059454424, -14.13700095477456, -0.008446330609236266, -0.7518789807527625, -0.6592470408336346, 24.930334413856905, 0.9947846627168635, 0.06069722565025286, -0.08197115893671557, 1.0368238750161218, 0.0, 0.0, 0.0, 1.0],
    [0.9855611232154124, 0.08702492327865143, -0.1452445758372364, 1.5612057864183284, -0.08762996800116608, -0.47183546430902273, -0.8773211032090376, 23.891441159727645, -0.1448803311602482, 0.877381289766923, -0.4573966897006847, 5.707901586339687, 0.0, 0.0, 0.0, 1.0],
    [-0.9996287189847969, -0.011250625658041283, 0.024816203740396364, -0.8895327251180234, 0.00865880608610832, -0.9947282406454857, -0.1021801606592122, 12.100256458616967, 0.025834967950647585, -0.10192734910805769, 0.9944563472554091, -23.467258673826535, 0.0, 0.0, 0.0, 1.0],              
];

function clamp(v, min, max){
    return Math.min(Math.max(v, min), max);
}

objects = [
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
];

object_files = [
    'static/mesh/actor_01.obj',
    'static/mesh/actor_02.obj',
    'static/mesh/actor_03.obj',
    'static/mesh/actor_04.obj',
    'static/mesh/actor_05.obj',
    'static/mesh/actor_06.obj',
    'static/mesh/actor_07.obj',
    'static/mesh/actor_08.obj',
];


let canvas, camera, scene, renderer, object, loader, material;

function create_avatar_scene(canvas_id) {
    
    canvas = document.getElementById(canvas_id);
    scene = new THREE.Scene();
    scene.background = new THREE.Color( 0xa0a0a0 );
    scene.fog = new THREE.Fog( 0xa0a0a0, 2, 90 );
    
    camera = new THREE.PerspectiveCamera( 40, canvas.offsetWidth/canvas.offsetHeight, 0.1, 500 );
    camera.position.y = 15;
    camera.position.z = 25;
    
    renderer = new THREE.WebGLRenderer( { canvas: canvas } );
    
    renderer.setClearColor( 0x000000);
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( canvas.offsetWidth, canvas.offsetHeight );
    
    const ambientLight = new THREE.AmbientLight( 0xcccccc, 0 );
    scene.add( ambientLight );
    
    const pointLight = new THREE.PointLight( 0xffffff, 1 );
    scene.add( pointLight );
    pointLight.position.set( 0, 20, 5 );
    
    const grid = new THREE.GridHelper( 200, 200, 0x000000, 0x000000 );
    grid.material.opacity = 0.3;
    grid.material.transparent = true;
    scene.add( grid );
    
    const controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( 0, 15, 0 );
    controls.update();
    controls.enablePan = false;
    controls.enableDamping = true;
    controls.autoRotate = true;
    controls.minDistance = 5.0;
    controls.maxDistance = 60.0;

    function add_camera(cam_transform) {
        const matrix = new THREE.Matrix4();
        matrix.set(...cam_transform);
        const cam_object = new THREE.PerspectiveCamera( 45, 0.75, -0.1, -2.0 );
        cam_object.matrixWorld = matrix;
        scene.add( new THREE.CameraHelper( cam_object ) );
    }
    
    cam_transforms.forEach(add_camera);

    function render() {
        controls.update();
        renderer.render( scene, camera );
        requestAnimationFrame( render );
    }

    material = new THREE.MeshNormalMaterial()
    const loading_manager = new THREE.LoadingManager(  );

    loader = new THREE.OBJLoader(loading_manager);
    render();
}

function remove_actors_from_scene(){
    for (let i = 0; i < objects.length; i++){
        if (objects[i] != null){
            scene.remove(objects[i]);
        }
    }
}

function onProgress( xhr ) {
    if ( xhr.lengthComputable ) {
        const percentComplete = xhr.loaded / xhr.total * 100;
        console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' );

    }
}
function onError() {}

function load_object(actor_index){
    file = object_files[actor_index];
    remove_actors_from_scene();
    if (objects[actor_index] == null){
        loader.load(file, function ( obj ) {
            objects[actor_index] = obj;
            const scale = 10;
            obj.scale.set(scale, scale, scale);
            obj.traverse( function ( child ) {
                if ( child.isMesh ) child.material = material;
            } );
            scene.add( obj );
        }, onProgress, onError );
    } else {
        scene.add(objects[actor_index]);
    }

    for (let i = 1; i <= 8; i++) {
        document.getElementById(`actor_button${i}`).style.background="white";
    }
    document.getElementById(`actor_button${actor_index + 1}`).style.background="lightgray";
}